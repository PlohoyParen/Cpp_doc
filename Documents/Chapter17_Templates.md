# Chapter 17: Шаблоны
## Шаблоны ф-ций 
Суть шаблона заключается в том, что компилятор сам подставляет тип данных в ф-цию на основе передаваемого типа данных. Например, 
```cpp
template <typename T> // объявление параметра шаблона функции
T max(T a, T b)
{
    return (a > b) ? a : b;
}
```
- При создании шаблона необходимо сделать объявление шаблона (`template <typename T>`). Вместо ключевого слова `typename` можно использовать `class` (`template <class T>`). Если речь идет об объявлении имени переменной шаблона, то разницы нет. Однако, в случаии, объявления переменной зависимой от шаблона необходимо использовать `typename`. Например,
  ```cpp
  template<typename T>              //(тут неважно)
  struct X : B<T>                   // "B<T>" is dependent on T
  {
      typename T::A* pa;            // "T::A" is dependent on T (тут важно)
                                    // (see below for the meaning of this use of "typename")
      void f(B<T>* pb) {
          static int i = B<T>::i;   // "B<T>::i" is dependent on T
          pb->j++;                  // "pb->j" is dependent on T
      }
  };
  ```
- Если объявляются сразу несколько параметров шаблона, то они пишутся через запятую: `template <typename T1, typename T2>`.
- Так как шаблоны работают не только для базовых типов данных, то компилятор так же может вставлять и пользовательские классы. Поэтому, имеет смысл писать шаблоны ф-ций с передачей и возвращением данных через const ссылки (а не по значению, как в примере в начале):
  ```cpp
  template <typename T>
  const T& max(const T& a, const T& b)
  {
      return (a > b) ? a : b;
  }
  ```

### Как компилятор реализует шаблоны ф-ций
Когда компилятор встречает вызов обычной ф-ции, он просто вставляет адрес реализации этой ф-ции на месте его вызова. В случаии шаблона ф-ции, компилятор вставляет всю реализацию ф-ции целиком (подобно опертору inline) на месте вызова заменяя переменные шаблона на подходящие типы данных. Таким образом, если шаблон ф-ции был вызван несколько раз с разными типами данных, то и реализация ф-ции будет вставлена несколько раз. Каждая такая вставка называется **экземпляром шаблонов функций**. Например:
```cpp
 
template <typename T>
const T& max(const T& a, const T& b)
{
    return (a > b) ? a : b;
}
 
int main()
{
    int i = max(4, 8);              /* на самом деле тут стоит 
                                    const int& max(const int& a, const int& b)
                                    {
                                        return (a > b) ? a : b;
                                    }
                                    */
    std::cout << i << '\n';
 
    double d = max(7.56, 21.434);   /* на самом деле тут стоит 
                                    const double& max(const double& a, const double& b)
                                    {
                                        return (a > b) ? a : b;
                                    }
                                    */
    std::cout << d << '\n';
        
    char ch = max('b', '9');        /* на самом деле тут стоит 
                                    const ch& max(const ch& a, const ch& b)
                                    {
                                        return (a > b) ? a : b;
                                    }
                                    */
    std::cout << ch << '\n';
        
    return 0;
}
```
